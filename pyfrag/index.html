<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Pyfrag | Snow</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
  <meta name="description" content="Theoretical Chemistry – ACMM – Department of Chemistry – Faculty of Sciences – Vrije Universiteit Amsterdam  Home People Group Members   Research Research Projects Research Tools PyFrag PyFrag Old   P">
<meta property="og:type" content="website">
<meta property="og:title" content="Pyfrag">
<meta property="og:url" content="http://yoursite.com/pyfrag/index.html">
<meta property="og:site_name" content="Snow">
<meta property="og:description" content="Theoretical Chemistry – ACMM – Department of Chemistry – Faculty of Sciences – Vrije Universiteit Amsterdam  Home People Group Members   Research Research Projects Research Tools PyFrag PyFrag Old   P">
<meta property="og:image" content="http://c.statcounter.com/t.php?sc_project=232560&java=1&security=&u1=9E3C867994D84F66E1F9FC73747B1C09&sc_random=0.9092635490650225&jg=10&rr=2.1.1.1.1.1.1.1.1&resolution=1920&h=1080&camefrom=http%3A//www.few.vu.nl/%7Ebickel/page-1/group-members/&u=http%3A//www.few.vu.nl/%7Ebickel/page-1/&t=People%20%7C%20Bickelhaupt%20Group%20%7C%20F.%20M.%20Bickelhaupt&rcat=d&rdomo=d&rdomg=10&sc_snum=1&sess=7a9eb4&p=0">
<meta property="og:updated_time" content="2018-06-19T11:56:29.600Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Pyfrag">
<meta name="twitter:description" content="Theoretical Chemistry – ACMM – Department of Chemistry – Faculty of Sciences – Vrije Universiteit Amsterdam  Home People Group Members   Research Research Projects Research Tools PyFrag PyFrag Old   P">
<meta name="twitter:image" content="http://c.statcounter.com/t.php?sc_project=232560&java=1&security=&u1=9E3C867994D84F66E1F9FC73747B1C09&sc_random=0.9092635490650225&jg=10&rr=2.1.1.1.1.1.1.1.1&resolution=1920&h=1080&camefrom=http%3A//www.few.vu.nl/%7Ebickel/page-1/group-members/&u=http%3A//www.few.vu.nl/%7Ebickel/page-1/&t=People%20%7C%20Bickelhaupt%20Group%20%7C%20F.%20M.%20Bickelhaupt&rcat=d&rdomo=d&rdomg=10&sc_snum=1&sess=7a9eb4&p=0">
  
    <link rel="alternate" href="/atom.xml" title="Snow" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head></html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Snow</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Suche"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="page-" class="article article-type-page" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/pyfrag/index.html" class="article-date">
  <time datetime="2018-06-18T15:47:22.000Z" itemprop="datePublished">2018-06-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        <h1 class="article-title" itemprop="name">
      Pyfrag
    </h1>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="http://www.chem.vu.nl/en/research/division-theoretical-chemistry/index.asp" target="_blank" rel="noopener">Theoretical Chemistry</a> – <a href="http://www.acmm.nl/" target="_blank" rel="noopener">ACMM</a> – <a href="http://www.chem.vu.nl/en/index.asp" target="_blank" rel="noopener">Department of Chemistry</a> – <a href="http://www.few.vu.nl/en/index.asp" target="_blank" rel="noopener">Faculty of Sciences</a> – <a href="http://www.vu.nl/en/index.asp" target="_blank" rel="noopener">Vrije Universiteit Amsterdam</a></p>
<ul>
<li><a href="https://sunxb05.github.io" title="Home" target="_blank" rel="noopener">Home</a></li>
<li><a href="/people" title="People">People</a><ul>
<li><a href="/groupmembers" title="Group Members">Group Members</a></li>
</ul>
</li>
<li><a href="/research" title="Research">Research</a><ul>
<li><a href="/researchprojects" title="Research Projects">Research Projects</a></li>
<li><a href="/researchtools" title="Research Tools">Research Tools</a></li>
<li><a href="/pyfrag" title="PyFrag">PyFrag</a></li>
<li><a href="/pyfragold" title="PyFrag Old">PyFrag Old</a></li>
</ul>
</li>
<li><a href="/publications" title="Publications">Publications</a><ul>
<li><a href="/refereedpublications" title="Refereed Publications">Refereed Publications</a></li>
<li><a href="/software" title="Software">Software</a></li>
<li><a href="/phdtheses" title="PhD Theses">PhD Theses</a></li>
</ul>
</li>
<li><a href="/curriculumvitae" title="Curriculum Vitae">Curriculum Vitae</a><ul>
<li><a href="/cronological" title="Cronological">Cronological</a></li>
<li><a href="/honors" title="Honors">Honors</a></li>
</ul>
</li>
<li><a href="/contact" title="Contact">Contact</a></li>
<li><a href="http://ec2-52-15-240-84.us-east-2.compute.amazonaws.com" title="Forum" target="_blank" rel="noopener">Forum</a></li>
</ul>
<h2 id="PyFrag"><a href="#PyFrag" class="headerlink" title="PyFrag"></a>PyFrag</h2><p><a href="/research" title="Research">«  Research</a><br><a href="/pyfragold" title="PyFrag Old">PyFrag Old</a><br><a href="/researchtools" title="Research Tools">Research Tools  »</a></p>
<h2 id="1-Introduction-to-PyFrag"><a href="#1-Introduction-to-PyFrag" class="headerlink" title="1. Introduction to PyFrag"></a>1. Introduction to PyFrag</h2><p>The PyFrag program is a ‘wrap-around’ for the Amsterdam Density Functional (ADF) package and facilitates the extension of the fragment analysis method implemented in ADF along an entire potential energy surfaces. The original version of PyFrag was developed by Willem-Jan van Zeist, Lando P. Wolters, F. Matthias Bickelhaupt, and Célia Fonseca Guerra at the Theoretical Chemistry department at Vrije Universiteit Amsterdam. The new PyFrag program was rewritten by Xiaobo Sun and Thomas Soini using the PLAMS library in the ADF package and has been included in the script collection in ADF 2017 and later version. Compared to the old PyFrag, the new version is more compact and easy to be maintained, expanded and upgraded. Also, due to its high compatibility with other python library tools developed by SCM, such as, PLAMS and QMworks, it can be used as a module in line with these computational chemistry job management tools to streamline a large flow of job. For more information about PLAMS and QMworks, the user can refer to <a href="https://www.scm.com/doc/Scripting/index.html" target="_blank" rel="noopener">https://www.scm.com/doc/Scripting/index.html</a>. PyFrag has been mainly used for research in the group of F. M. Bickelhaupt to enable a user-friendly analysis of reaction paths in terms of the Extended Activation Strain model of chemical reactivity(ASM). The following papers give an example how PyFrag can be used in real reaction path analysis[1] and a review of how Activation Strain model can help to resolve diverse chemistry problems[2-4]. For anyone who are interested in the old version of PyFrag or try to report a bug or add more functions to the new version of PyFrag, please visit <a href="https://github.com/sunxb05/backup/tree/master/pyfrag3" target="_blank" rel="noopener">https://github.com/sunxb05/backup/tree/master/pyfrag3</a></p>
<p><a href="101">1</a> W.-J. van Zeist, C. Fonseca Guerra, F. M. Bickelhaupt, <a href="http://dx.doi.org/10.1002/jcc.20786" target="_blank" rel="noopener"><em>J. Comput. Chem.</em> <strong>2008</strong>, <em>29</em>, 312-315</a>.</p>
<p>[2] I. Fernandez, F. M. Bickelhaupt, <a href="http://dx.doi.org/10.1039/C4CS00055B" target="_blank" rel="noopener"><em>Chem. Soc. Rev.</em> <strong>2014</strong>, <em>43</em>, 4953-4967</a>.</p>
<p>[3] L. P. Wolters, F. M. Bickelhaupt, <a href="http://dx.doi.org/10.1002/wcms.1221" target="_blank" rel="noopener"><em>WIRES Comput. Mol. Sci.</em> <strong>2015</strong>, <em>5</em>, 324-343</a>.</p>
<p>[4] F. M. Bickelhaupt, K. N. Houk <a href="http://dx.doi.org/10.1002/ange.201701486" target="_blank" rel="noopener"><em>Angew. Chem.</em> <strong>2017</strong>, <em>129</em>, 10204-10221</a>; <a href="http://dx.doi.org/10.1002/anie.201701486" target="_blank" rel="noopener"><em>Angew. Chem. Int. Ed.</em> <strong>2017</strong>, <em>56</em>, 10070-10086</a>.</p>
<h2 id="2-How-to-Run-PyFrag"><a href="#2-How-to-Run-PyFrag" class="headerlink" title="2. How to Run PyFrag"></a>2. How to Run PyFrag</h2><p>PyFrag is a program written in the highly transferable Python programming language. Running it on any given system should pose no problems, provided Python and the ADF package have been installed. PyFrag can be easily run on command line and constructs the necessary ADF jobs from it by reading input statements. By reading or constructing a series of geometry points, a series of ADF fragment-analysis calculations will be performed, the results of which are gathered in a neat text data file. To run PyFrag on command line is much like to run any other python code, you just simply put command like “startpython pyfrag.py pyfrag_job_script”, in which startpython is a wrap-up python version in ADF. All related files generated by ADF will be saved in a working directory, automatically generated by PLAMS.</p>
<p>Preparation of input of PyFrag is easy. PyFrag input can be divided into two parts, as shown by an example below. One part is to set up basic parameters such as how to define two fragments and specify which data should be printed later, etc. A second part is just normal ADF input for a single point calculation. It is the user’s own responsibility to set all the right ADF environment variables, so that ADF can run properly. In principle, nothing needs to be changed compared to running a single ADF job. To run it in cluster, for example, with a job management like “Slurm”, one can write a bash script to call PyFrag.</p>
<p>Command line example to run PyFrag:</p>
<p><em>startpython pyfrag.py –-ircpath molecule.xyz –fragment 2 –fragment 1 3 4 5 6 –strain 0 –strain -554.1 –bondlength 1 6 1.093 –angle 2 1 6 180 –VDD 2 1 6 –hirshfeld frag1 –irrepOI AA –orbitalenergy frag2 LUMO –adfinput basis.type=TZ2P –adfinputfile adfinputfile</em></p>
<p>Bash script example to run PyFrag:</p>
<p><em>#!/bin/bash</em></p>
<p>_#SBATCH -J pyfrag<em>input</em></p>
<p><em>#SBATCH -N 1</em></p>
<p><em>#SBATCH -t 1:00:00</em></p>
<p><em>#SBATCH –partition=tc5</em></p>
<p><em>#SBATCH –output=%job.stdout</em></p>
<p><em>#SBATCH –error=%job.stderr</em></p>
<p><em>export NSCM=16</em></p>
<p>_export SCM<em>TMPDIR=$TMPDIR</em></p>
<p><em>startpython PathtoPyfrag/PyFrag.py \</em></p>
<p><em>–name filename \</em></p>
<p><em>–ircpath PathtoMolecule/molecule.xyz \</em></p>
<p><em>–fragment 2 –fragment 1 3 4 5 6 –strain 0 –strain -554.1 \</em></p>
<p><em>–bondlength 1 6 1.093 \</em></p>
<p><em>–angle 2 1 6 180 \</em></p>
<p><em>–VDD 2 1 6 \</em></p>
<p><em>–hirshfeld frag1 \</em></p>
<p><em>–irrepOI AA \</em></p>
<p><em>–irrepOI AAA \</em></p>
<p><em>–orbitalenergy frag1 HOMO \</em></p>
<p><em>–orbitalenergy frag2 LUMO \</em></p>
<p><em>–orbitalenergy AA frag2 5 \</em></p>
<p><em>–population frag1 HOMO \</em></p>
<p><em>–population AA frag2 5 \</em></p>
<p><em>–overlap frag1 HOMO frag2 LUMO \</em></p>
<p><em>–overlap S frag1 5 AA frag2 4 \</em></p>
<p><em>–adfinput basis.type=TZ2P –adfinputfile PathtoADFfile/adfinputfile</em></p>
<h2 id="3-Options-and-specifications"><a href="#3-Options-and-specifications" class="headerlink" title="3.Options and specifications"></a>3.Options and specifications</h2><p>On a line, everything after a ‘#’ will be ignored, allowing for comments in your inputfile. The data file pyfrag.txt by default will contain, as columns:</p>
<p><em>•</em> <em>The filenames of the fragment analysis calculations, which are numbered for each step in the calculations.<br>• The total interaction energy (kcal/mol)<br>• The Pauli repulsion (kcal/mol)<br>• The Electrostatic interaction (kcal/mol)<br>• The Orbital interaction (kcal/mol__)</em></p>
<p>Provide name for the directory, otherwise the directory will be named by PID.</p>
<p><em>•</em> <em>–name filename</em></p>
<p>User can also rerun the same calculation to extract more information from the t21 files in the old job, as long as the right path is provided.</p>
<p><em>•</em> <em>–restart path to old job</em></p>
<p><em>for example:</em></p>
<p><em>• –restart /Users/Desktop/plams.13018</em></p>
<p>Specify the filename of the LT or IRC output file you wish to analyze, both tape 21 and normal output files can be given. A tape 21 file should have a .t21 extension! Please make sure this is the case. You can specify two output files for an IRC t21 (backward and forward). A text file containing coordinates of an IRC calculation is also acceptable, for example, a text file generated by ADFmovie or Gaussian.</p>
<p><em>•</em> <em>–ircpath filename.xyz</em></p>
<p><em>•</em> <em>–irct21 filename.t21</em></p>
<p><em>•</em> <em>–lt filename.t21</em></p>
<p>These following statements allow you to define the fragments in the analysis. For each of the fragments you supply a list of the numbers for the atoms as they exist on the LT or IRC file. The program will check if they match with the order as in the IRC or LT calculation file. It will print a statement in the error log if it thinks the order is wrong.</p>
<p><em><br>• –fragment atomnrs</em></p>
<p><em>for example:</em></p>
<p><em>• –fragment 2 –fragment 1 3 4 5 6</em></p>
<p>There are two ways to specify a parameter set for an ADF calculation. Either one can directly set it or one can provide a file containing all information which can be used repeatedly.</p>
<p><em>• –adfinput adfparameter</em></p>
<p><em>• –adfinputfile adfinputfile</em></p>
<p><em>for example:</em></p>
<p><em>• –adfinput basis.type=TZ2P</em></p>
<p><em>• –adfinputfile adfinputfile</em></p>
<p>The adfinputfile simply lists all parameters, ADF will need to do any type of calculation. It is similar to a normal ADF input except here all options are connected by “=”. One example file is shown as follows:</p>
<p><em>NumericalQuality=VeryGood</em></p>
<p><em>XC.GGA=OPBE</em></p>
<p><em>Basis.core=None</em></p>
<p><em>Charge=0</em></p>
<p><em>Symmetry=AUTO</em></p>
<p><em>RELATIVISTIC=Scalar ZORA</em></p>
<p><em>eprint.sfo=eig ovl</em></p>
<p>The following possibilities are optional. Users can choose what information to print after a PyFrag calculation. For instance, one can specify if the strain energy is to be printed for the fragments. Or one can specify the equilibrium energies (in kcal/mol) for the fragments. Beware that the order of this specification should correspond to the order of the fragment definition. This value will then simply be subtracted from the energy of the fragment in question. The program will print the individual strain values for each fragment, plus the total strain and total energy.</p>
<p><em>• –strain fragenergy</em></p>
<p><em>for example:</em></p>
<p><em>• –strain -301.01<br>• –strain -19.02</em></p>
<p>To specify the bond length to be printed for each geometry step, just indicate the atom numbers as they appear in the input order of the total molecule. Specifying bond_diff as well subtracts this value from the actual bond length.</p>
<p>_• –bondlength atomnr1 atomnr2 bond<em>diff</em></p>
<p>To specify the angle between atoms 1, 2 and 3 to be printed for each geometry step, just indicate the atom numbers as they appear in the input order of the total molecule. Specifying angle_diff as well subtracts this value from the actual angle.</p>
<p>_• –angle atomnr1 atomnr2 atomnr3 angle<em>diff</em></p>
<p>The following will print the Hirshfeld charges for the fragment. Note that the order of the fragments as used internally by ADF may differ from what you would expect. Note also that Hirshfeld charges as computed in a fragment analysis differ from those obtained in a ‘normal’ calculation from basic (spherical average-of configurations) ADF atoms like simple single point calculations.</p>
<p><em>• – hirshfeld frag1</em></p>
<p>The following prints the VDD charges on the atoms with numbers as given by atomnrs. Note also that VDD charges as computed in a fragment analysis differ from those obtained in a ‘normal’ calculation from basic (spherical average-of configurations) atoms like single point calculation.</p>
<p><em>• – VDD atomnrs</em></p>
<p><em>for example:</em></p>
<p><em>• – VDD 1 2</em></p>
<p>Through in the input below, the value of the orbital interaction energy will be printed for certain available irrep. The irrep symbol relates to the symmetry of the whole molecule.</p>
<p><em>• – irrepOI oi irrep</em></p>
<p><em>for example:</em></p>
<p><em>• – irrepOI AA</em></p>
<p>The statement below will print the overlap between orbital numbers orb1 on frag1 and orb2 on frag2 in irrep as they appear in the fragment analysis calculation. It can also print the overlap between the HOMO’s of fragment one (frag1) and the LUMOs of fragment two (orbitals as found on the fragment calculations). If the orbitals found in this way differ in symmetry, an overlap value of zero is returned. It should be noted that irrep and orbital number refers to each fragment, rather than the whole molecule. Especially, when it comes to frozen core situation, the count of orbital number should not include core orbitals. This rule also applies to the situation of printing orbital energy and population for orbitals of certain fragment.</p>
<p><em>• –overlap frag1 HOMO/LUMO frag2 HOMO/LUMO</em></p>
<p><em>• –overlap irrep1 frag1 orb1 irrp2 frag2 orb2</em></p>
<p><em>for example:</em></p>
<p><em>• –overlap frag1 HOMO frag2 LUMO</em></p>
<p><em>• –overlap S frag1 5 AA frag2 4</em></p>
<p>Through the input below, the orbital energy for a fragment orbital will be printed in available irrep.</p>
<p><em>• – orbitalenergy frag HOMO/LUMO</em></p>
<p><em>• – orbitalenergy irrep frag orb</em></p>
<p><em>for example:</em></p>
<p><em>• – orbitalenergy frag1 HOMO</em></p>
<p><em>• – orbitalenergy AA frag2 5</em></p>
<p>Through the input below, the Mulliken population for a fragment orbital will be printed in available irrep.</p>
<p><em>• – population frag HOMO/LUMO</em></p>
<p><em>• – population irrep frag orb</em></p>
<p><em>for example:</em></p>
<p><em>• – population frag1 HOMO</em></p>
<p><em>• – population AA frag2 5</em></p>
<h4 id="Popular-Links"><a href="#Popular-Links" class="headerlink" title="Popular Links"></a>Popular Links</h4><p>• <a href="http://apps.webofknowledge.com.vu-nl.idm.oclc.org/WOS_GeneralSearch_input.do?product=WOS&amp;search_mode=GeneralSearch&amp;SID=E5y9i42QJFIPOm1Dj35&amp;preferencesSaved=" target="_blank" rel="noopener">Web of Science</a>•  <a href="http://webbook.nist.gov/chemistry/" target="_blank" rel="noopener">NIST Chemistry Webbook</a><br>• <a href="http://cat.ubvu.vu.nl/" target="_blank" rel="noopener">Library</a><br>• <a href="https://vunet.vu.nl/" target="_blank" rel="noopener">VUNET</a></p>
<p><a href="http://www.statcounter.com/" target="_blank" rel="noopener"><img src="http://c.statcounter.com/t.php?sc_project=232560&amp;java=1&amp;security=&amp;u1=9E3C867994D84F66E1F9FC73747B1C09&amp;sc_random=0.9092635490650225&amp;jg=10&amp;rr=2.1.1.1.1.1.1.1.1&amp;resolution=1920&amp;h=1080&amp;camefrom=http%3A//www.few.vu.nl/%7Ebickel/page-1/group-members/&amp;u=http%3A//www.few.vu.nl/%7Ebickel/page-1/&amp;t=People%20%7C%20Bickelhaupt%20Group%20%7C%20F.%20M.%20Bickelhaupt&amp;rcat=d&amp;rdomo=d&amp;rdomg=10&amp;sc_snum=1&amp;sess=7a9eb4&amp;p=0" alt="StatCounter - Free Web Tracker and Counter"></a></p>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/pyfrag/index.html" data-id="cjilmxorw000941ul18r0dsy3" class="article-share-link">Teilen</a>
      
      
    </footer>
  </div>
  
    
  
</article></section>
        
          <aside id="sidebar">
  
    
  
    
  
    
  
    <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li></ul>
    </div>
  </div>
  
    <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/06/18/home/">Home</a>
          </li>
        
      </ul>
    </div>
  </div>
  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Xiaobo Sun<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
  </div>
</body>
